<!DOCTYPE html>

<head>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>


    <script>   

        let todoItems = []
       
        function handleSubmit() {
            const item = document.getElementById("todo-item").value;
            if (item == "" || item == undefined) {
                console.log("item is empty")
                return false
            }
            
            const dueDate = document.getElementById("due-date").value;
            if (dueDate == "" || dueDate == undefined) {
                console.log("duedate is empty")
                return false
            }
            const itemNum = todoItems.push({ item, dueDate })
            console.log(todoItems, itemNum)
            const todoTable = document.getElementById("todo-table").insertRow(itemNum)

            const a = todoTable.insertCell(0)
            const b = todoTable.insertCell(1)
            const c = todoTable.insertCell(2)
            const d = todoTable.insertCell(3)
            const e = todoTable.insertCell(4)


            a.innerHTML = itemNum
            b.innerHTML = item
            c.innerHTML = dueDate
            d.innerHTML = '<input type="button" value="x" class="btn btn-danger" onclick="handleDelete('+ itemNum +')"/>'
            e.innerHTML = '<input type="button" value="Edit" class="btn btn-secondary" onclick="onEdit"/>'
        }

        function handleDelete(itemNumber) {
            console.log(itemNumber)
            const itemIndex = parseInt(itemNumber) - 1
            const todoTable = document.getElementById("todo-table").deleteRow(itemIndex)
            todoItems.splice(itemIndex,1)
            console.log(todoItems)
        }

        function handleEdit(itemnumber) {
            console.log(itemNumber)
            const itemIndex = parseInt(itemNumber) - 1
            const todoTable = document.getElementById("todo-table").deleteRow(itemIndex)
            todoItems.splice(itemIndex,1)
            console.log(todoItems)
        }

        /*

        Fix the bug causing incorrect deletion of line-items, in the index and in the DOM. 
        - The first "Apple" array submitted will not delete in the index, as shown in the console. In addition, when there are only 2 line items, clicking the Delete button on the second line item WILL delete the first "Apple" submission and simply move the 2nd line item up. This happens with every additional 2 line items added if items are deleted in the order they were submitted. SOMETHING IS UP WITH THE FIRST TABLE ROW, it should not be affected. It behaves as a line item when all indexed items have been deleted, which CAN happen if only one item is submitted (Apple), and no others.
        - 
        
        function 1
        - Edit onClick makes data editable
        E=> onEdit (itemNumber)
                
        function 2
        - Edit button replaced by save button

        function 3
        - Save button clock updates table & array

        Optional:
        - Adjust the colors using bootstrap and improve design/css
        - Add an ascending and descending button to swap line-item positions

        */


    </script>
</head>

<body>
    <div class="container">
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand" href="#">To-Do List App</a>
        </nav>
        <form>
            <div class="row">
                <div class="col">
                    <input type="text" class="form-control" id="todo-item" size=50 value="0 Apple" />
                    <label class="form-label">To Do Item</label>
                </div>
                <div class="col">
                    <input type="date" class="form-control" id="due-date" size=10 value="2022-02-19" />
                    <label class="form-label">Due By</label>
                </div>
                <div class="col">
                    <input type="button" class="btn btn-primary" id="create-item" value="create-item"
                        onclick="handleSubmit()" />
                </div>
            </div>
        </form>




        <table class="table" id="todo-table">
            <thead>
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Todo Item</th>
                    <th scope="col">Due Date</th>
                    <th scope="col">Actions</th>
                </tr>
            </thead>
            <tbody>

            </tbody>
        </table>





    </div>
</body>

</html>